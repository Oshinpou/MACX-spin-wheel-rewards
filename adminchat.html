<!DOCTYPE html>
<html>
<head>
    <title>MACX - Admin Chat Panel</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #0d0d0d;
            font-family: Arial, sans-serif;
            color: #fff;
            text-align: center;
        }

        .container {
            margin: 50px auto;
            width: 80%;
        }

        h2 {
            color: #FFD700;
            margin-bottom: 20px;
        }

        .chat-box {
            width: 100%;
            height: 300px;
            background: #2c2c2c;
            overflow-y: scroll;
            border: 1px solid #444;
            border-radius: 5px;
            padding: 10px;
            text-align: left;
        }

        .chat-box p {
            margin: 5px 0;
        }

        .message-input {
            width: calc(100% - 80px);
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #444;
            border-radius: 5px;
        }

        button {
            padding: 10px 20px;
            margin-top: 10px;
            background: #FFD700;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #b7952c;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Admin Panel - User Chats</h2>

        <label for="userSelect">Select User Chat:</label>
        <select id="userSelect" onchange="loadChat()">
            <option value="">Select User</option>
        </select>

        <div class="chat-box" id="chatBox">
            <p>üí¨ Select a user to view or manage chat...</p>
        </div>

        <input type="text" id="messageInput" class="message-input" placeholder="Type a reply..." />
        <button onclick="sendReply()">Send Reply</button>
        <button onclick="deleteChat()">Delete Chat</button>
    </div>

    <script>
        // Load All User Chats
        let allChats = {};
        for (let key in localStorage) {
            if (key.startsWith('chat_')) {
                allChats[key.replace('chat_', '')] = JSON.parse(localStorage.getItem(key));
            }
        }

        // Populate User Select
        const userSelect = document.getElementById('userSelect');
        for (let username in allChats) {
            let option = document.createElement('option');
            option.value = username;
            option.innerText = username;
            userSelect.appendChild(option);
        }

        let selectedUser = '';
        let chatData = [];

        // Load Chat for Selected User
        function loadChat() {
            selectedUser = userSelect.value;
            if (selectedUser === '') {
                document.getElementById('chatBox').innerHTML = '<p>üí¨ Select a user to view or manage chat...</p>';
                return;
            }

            chatData = allChats[selectedUser] || [];
            updateChatBox();
        }

        // Send Admin Reply
        function sendReply() {
            let message = document.getElementById('messageInput').value;
            if (message.trim() === '' || selectedUser === '') {
                alert('‚ùó Message or user not selected.');
                return;
            }

            let replyMessage = {
                sender: 'admin',
                message: message,
                timestamp: new Date().toLocaleString()
            };

            chatData.push(replyMessage);
            localStorage.setItem('chat_' + selectedUser, JSON.stringify(chatData));
            updateChatBox();
            document.getElementById
